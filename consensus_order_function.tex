\section{Consensus order function}\label{sec:order_function}
The code sample below shows the implementation of the consensus order function.
\lstset{language=c++, numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=5pt, tabsize=4}%, 
\begin{lstlisting}
bool order_less(const Event a, const Event b) @safe {
	order_compare_iteration_count++;
	if (a.received_order is b.received_order) {
		if (a._father && b._father) {
			return order_less(a._father, b._father);
		}
		if (a._father && b._mother) {
			return order_less(a._father, b._mother);
		}
		if (a._mother && b._father) {
			return order_less(a._mother, b._father);
		}
		if (!a.isFatherLess && !b.isFatherLess) {
			return order_less(a._mother, b._mother);
		}
		if (!a.isFatherLess) {
			return false;
		}
		if (!b.isFatherLess) {
			return true;
		}
		bool rare_less(Buffer a_print, Buffer b_print) {
			rare_order_compare_count++;
			pragma(msg, "review(cbr): Concensus order changed");
			return a_print < b_print;
		}
		assert(a.isFatherLess && b.isFatherLess);
		return rare_less(a.fingerprint, b.fingerprint);
	}
	return a.received_order < b.received_order;
}
\end{lstlisting}
